import{j as e,q as v,z as E,L as w,w as z}from"./ui-vendor-eBBau3_-.js";import{u as L,d as P,r as o,L as U}from"./react-vendor-ClBxwFoA.js";import{u as A,s as p}from"./index-DZmIGIg5.js";import"./store-vendor-CJ7bJ5Yt.js";const V=()=>{const j=L(),y=P(),{login:N}=A(),k=j.pathname.includes("signup"),[a,f]=o.useState(k),[m,b]=o.useState(!1),[n,g]=o.useState(""),[h,_]=o.useState(""),[d,c]=o.useState(!1),[u,t]=o.useState(null),[x,l]=o.useState(null),S=async r=>{r.preventDefault(),c(!0),t(null),l(null);try{if(a){const{data:s,error:i}=await p.auth.signUp({email:n,password:h});if(i)throw i;l("Email de confirmation envoyé ! Vérifiez votre boîte mail pour activer le compte.")}else{const{data:s,error:i}=await p.auth.signInWithPassword({email:n,password:h});if(i)throw i;s.user&&s.user.email&&(N({id:s.user.id,email:s.user.email}),y("/"))}}catch(s){console.error("Auth Error:",s),t(s.message||"Une erreur est survenue.")}finally{c(!1)}},C=async r=>{if(r.preventDefault(),!n){t("Veuillez entrer votre adresse email.");return}c(!0),t(null),l(null);try{const{error:s}=await p.auth.resetPasswordForEmail(n,{redirectTo:`${window.location.origin}/#/reset-password`});if(s)throw s;l("Un email de réinitialisation a été envoyé ! Vérifiez votre boîte mail."),b(!1)}catch(s){t(s.message||"Une erreur est survenue lors de l'envoi de l'email.")}finally{c(!1)}};return e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center py-12 px-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex mb-6 border-2 border-black rounded-lg overflow-hidden shadow-neo-sm bg-white",children:[e.jsx("button",{onClick:()=>{f(!1),t(null),l(null)},className:`flex-1 py-3 font-bold text-sm uppercase tracking-wider transition-colors ${a?"bg-white text-gray-500 hover:bg-gray-50":"bg-neo-black text-white"}`,children:"Connexion"}),e.jsx("button",{onClick:()=>{f(!0),t(null),l(null)},className:`flex-1 py-3 font-bold text-sm uppercase tracking-wider transition-colors ${a?"bg-neo-yellow text-black border-l-2 border-black":"bg-white text-gray-500 hover:bg-gray-50 border-l-2 border-gray-200"}`,children:"Inscription"})]}),e.jsxs("div",{className:"bg-white border-2 border-black rounded-lg p-8 shadow-neo relative",children:[e.jsx("div",{className:"absolute -top-3 -right-3 w-8 h-8 bg-neo-violet border-2 border-black rounded-full flex items-center justify-center shadow-sm z-10",children:e.jsx("span",{className:"font-bold text-lg",children:"!"})}),e.jsx("h2",{className:"font-display text-3xl font-bold mb-2 text-center",children:a?"Rejoignez le club.":"Bon retour."}),e.jsx("p",{className:"text-center text-gray-500 mb-8 text-sm",children:a?"Créez un compte pour sauvegarder vos crédits.":"Connectez-vous pour accéder à vos outils."}),m?e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Entrez votre adresse email et nous vous enverrons un lien pour réinitialiser votre mot de passe."})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Email"}),e.jsx("input",{type:"email",required:!0,value:n,onChange:r=>g(r.target.value),className:"w-full p-3 border-2 border-black rounded-md bg-neo-white focus:ring-0 focus:shadow-[2px_2px_0px_0px_#000] transition-all",placeholder:"votre@email.com"})]}),u&&e.jsxs("div",{className:"p-3 bg-red-50 border-2 border-red-100 text-red-600 text-xs font-bold rounded flex items-center",children:[e.jsx(v,{className:"w-4 h-4 mr-2 flex-shrink-0"})," ",u]}),x&&e.jsxs("div",{className:"p-3 bg-green-50 border-2 border-green-100 text-green-600 text-xs font-bold rounded flex items-center",children:[e.jsx(E,{className:"w-4 h-4 mr-2 flex-shrink-0"})," ",x]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{b(!1),t(null),l(null)},className:"flex-1 py-3 bg-gray-100 text-black font-bold border-2 border-black rounded-md hover:bg-gray-200 transition-all",children:"Annuler"}),e.jsxs("button",{type:"submit",disabled:d,className:"flex-1 py-3 bg-neo-black text-white font-bold border-2 border-black rounded-md shadow-[3px_3px_0px_0px_#86efac] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all disabled:opacity-70 disabled:cursor-wait flex justify-center items-center gap-2",children:[d&&e.jsx(w,{className:"w-4 h-4 animate-spin"}),"Envoyer"]})]})]}):e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Email"}),e.jsx("input",{type:"email",required:!0,value:n,onChange:r=>g(r.target.value),className:"w-full p-3 border-2 border-black rounded-md bg-neo-white focus:ring-0 focus:shadow-[2px_2px_0px_0px_#000] transition-all",placeholder:"votre@email.com"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("label",{className:"block text-sm font-bold",children:"Mot de passe"}),!a&&e.jsx("button",{type:"button",onClick:()=>b(!0),className:"text-xs text-neo-violet hover:underline font-bold",children:"Mot de passe oublié ?"})]}),e.jsx("input",{type:"password",required:!m,minLength:6,value:h,onChange:r=>_(r.target.value),disabled:m,className:"w-full p-3 border-2 border-black rounded-md bg-neo-white focus:ring-0 focus:shadow-[2px_2px_0px_0px_#000] transition-all disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"••••••••"})]}),u&&e.jsxs("div",{className:"p-3 bg-red-50 border-2 border-red-100 text-red-600 text-xs font-bold rounded flex items-center",children:[e.jsx(v,{className:"w-4 h-4 mr-2 flex-shrink-0"})," ",u]}),x&&e.jsxs("div",{className:"p-3 bg-green-50 border-2 border-green-100 text-green-600 text-xs font-bold rounded flex items-center",children:[e.jsx(z,{className:"w-4 h-4 mr-2 flex-shrink-0"})," ",x]}),e.jsxs("button",{type:"submit",disabled:d,className:"w-full py-3 bg-neo-black text-white font-bold border-2 border-black rounded-md shadow-[3px_3px_0px_0px_#86efac] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all disabled:opacity-70 disabled:cursor-wait flex justify-center items-center gap-2",children:[d&&e.jsx(w,{className:"w-4 h-4 animate-spin"}),a?"Créer mon compte":"Se connecter"]})]})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["En continuant, vous acceptez nos ",e.jsx(U,{to:"/legal",className:"underline font-bold text-black",children:"CGU"}),"."]})})]})})};export{V as Auth};
