import{j as e,r as w,q as v,w as j,L as N}from"./ui-vendor-eBBau3_-.js";import{d as y,i as k,r as t}from"./react-vendor-ClBxwFoA.js";import{s as i}from"./index-DZmIGIg5.js";import"./store-vendor-CJ7bJ5Yt.js";const E=()=>{const l=y(),[n]=k(),[a,b]=t.useState(""),[d,f]=t.useState(""),[c,u]=t.useState(!1),[m,o]=t.useState(null),[x,h]=t.useState(null);t.useEffect(()=>{(async()=>{const{data:{session:r}}=await i.auth.getSession();r||(n.get("hash"),n.get("type"))})()},[n]);const g=async s=>{if(s.preventDefault(),o(null),h(null),a.length<6){o("Le mot de passe doit contenir au moins 6 caractères.");return}if(a!==d){o("Les mots de passe ne correspondent pas.");return}u(!0);try{const{data:{session:r},error:S}=await i.auth.getSession();if(!r)throw new Error("Session expirée. Veuillez demander un nouveau lien de réinitialisation.");const{error:p}=await i.auth.updateUser({password:a});if(p)throw p;h("Mot de passe réinitialisé avec succès ! Redirection..."),setTimeout(()=>{l("/login")},2e3)}catch(r){o(r.message||"Une erreur est survenue lors de la réinitialisation.")}finally{u(!1)}};return e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center py-12 px-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"bg-white border-2 border-black rounded-lg p-8 shadow-neo relative",children:[e.jsx("div",{className:"absolute -top-3 -right-3 w-8 h-8 bg-neo-violet border-2 border-black rounded-full flex items-center justify-center shadow-sm z-10",children:e.jsx(w,{className:"w-4 h-4 text-white"})}),e.jsx("h2",{className:"font-display text-3xl font-bold mb-2 text-center",children:"Nouveau mot de passe"}),e.jsx("p",{className:"text-center text-gray-500 mb-8 text-sm",children:"Choisissez un nouveau mot de passe sécurisé pour votre compte."}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Nouveau mot de passe"}),e.jsx("input",{type:"password",required:!0,minLength:6,value:a,onChange:s=>b(s.target.value),className:"w-full p-3 border-2 border-black rounded-md bg-neo-white focus:ring-0 focus:shadow-[2px_2px_0px_0px_#000] transition-all",placeholder:"••••••••"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 caractères"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-1",children:"Confirmer le mot de passe"}),e.jsx("input",{type:"password",required:!0,minLength:6,value:d,onChange:s=>f(s.target.value),className:"w-full p-3 border-2 border-black rounded-md bg-neo-white focus:ring-0 focus:shadow-[2px_2px_0px_0px_#000] transition-all",placeholder:"••••••••"})]}),m&&e.jsxs("div",{className:"p-3 bg-red-50 border-2 border-red-100 text-red-600 text-xs font-bold rounded flex items-center",children:[e.jsx(v,{className:"w-4 h-4 mr-2 flex-shrink-0"})," ",m]}),x&&e.jsxs("div",{className:"p-3 bg-green-50 border-2 border-green-100 text-green-600 text-xs font-bold rounded flex items-center",children:[e.jsx(j,{className:"w-4 h-4 mr-2 flex-shrink-0"})," ",x]}),e.jsxs("button",{type:"submit",disabled:c,className:"w-full py-3 bg-neo-black text-white font-bold border-2 border-black rounded-md shadow-[3px_3px_0px_0px_#86efac] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-none transition-all disabled:opacity-70 disabled:cursor-wait flex justify-center items-center gap-2",children:[c&&e.jsx(N,{className:"w-4 h-4 animate-spin"}),"Réinitialiser le mot de passe"]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>l("/login"),className:"text-sm text-neo-violet hover:underline font-bold",children:"Retour à la connexion"})})]})})})};export{E as ResetPassword};
